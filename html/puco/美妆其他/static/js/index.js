// Generated by CoffeeScript 2.6.0
(function() {
  var Hs, root;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  // !!!! Hotpoor root object
  root.Hs || (root.Hs = {});

  Hs = root.Hs;

  root.num = 0;

  $(function() {
    var add_tr, load_comments;
    console.log("local demo puco");
    add_tr = function(content_json) {
      var error, kol, redId;
      kol = content_json["data"];
      try {
        redId = kol["redId"];
      } catch (error1) {
        error = error1;
        console.log("error", kol);
        return;
      }
      if ($(`#xhs_${redId}`).length < 1) {
        root.num = root.num + 1;
        return $(".a").append(`<tr style="margin:10px;" id="xhs_${redId}">
    <td>${num}</td>
    <td>${kol["redId"]}</td>
    <td>${kol["name"]}</td>
    <td>${kol["currentLevel"]}</td>
    <td>${(parseInt(kol["likeCollectCountInfo"]) / parseInt(kol["totalNoteCount"])).toFixed(2)}</td>
    <td>${kol["likeCollectCountInfo"]}</td>
    <td>${kol["totalNoteCount"]}</td>
    <td>${kol["fansCount"]}</td>
    <td>${kol["businessNoteCount"]}</td>
    <td>${kol["userId"]}</td>
    <td>
        <div><a target="_blank" href="https://www.xiaohongshu.com/user/profile/${kol["userId"]}">${kol["userId"]}</a></div>
    </td>
    <td>
        <div><a target="_blank" href="https://pgy.xiaohongshu.com/solar/advertiser/kol/${kol["userId"]}">${kol["userId"]}</a></div>
    </td>
    <td>${kol["picturePrice"]}</td>
    <td>${kol["videoPrice"]}</td>
</tr>`);
      }
    };
    load_comments = function(chat_id = null, comment_id = null) {
      if (chat_id === null) {
        return;
      }
      return $.ajax({
        url: "https://www.qianshanghua.com/api/page/comment/load",
        data: {
          chat_id: chat_id,
          comment_id: comment_id
        },
        dataType: "json",
        type: "GET",
        success: function(data) {
          var add_tr_next, comments, content_json, error, i, last_comment_id, len, one;
          // console.log data
          comments = data.comments;
          for (i = 0, len = comments.length; i < len; i++) {
            one = comments[i];
            if (one[4] === "v") {
              continue;
            }
            add_tr_next = false;
            try {
              content_json = JSON.parse(one[4]);
              add_tr_next = true;
            } catch (error1) {
              error = error1;
              add_tr_next = false;
            }
            if (add_tr_next) {
              add_tr(content_json);
            }
          }
          console.log(chat_id, comment_id, data.last_comment_id);
          last_comment_id = data.last_comment_id;
          if (data.last_comment_id !== null) {
            return load_comments(chat_id, last_comment_id);
          }
        },
        error: function(data) {
          return console.log(data);
        }
      });
    };
    return $(window).on("load", function(e) {
      $(".a").append(`<tr style="margin:10px;">
    <th>编号</th>
    <th>小红书号</th>
    <th>昵称</th>
    <th>level</th>
    <th>均篇点赞收藏</th>
    <th>点赞收藏</th>
    <th>笔记数</th>
    <th>粉丝数</th>
    <th>商业笔记</th>
    <th>userId</th>
    <th>个人主页</th>
    <th>蒲公英主页</th>
    <th>笔记图文一口价</th>
    <th>视频图文一口价</th>
</tr>`);
      return load_comments("a7afbb1de4b94c42af2ace6374005b07");
    });
  });

}).call(this);
